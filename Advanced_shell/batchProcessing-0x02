#!/bin/bash

# Directory to save JSON data files
DATA_DIR="pokemon_data"

# List of Pokémon to retrieve
POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Base API URL
API_BASE="https://pokeapi.co/api/v2/pokemon"

# Create data directory if it doesn't exist
mkdir -p "$DATA_DIR"

# Loop through each Pokémon and fetch data
for POKE in "${POKEMONS[@]}"; do
    echo "Fetching data for $POKE..."

    # Fetch data using curl with silent mode and store HTTP status
    HTTP_STATUS=$(curl -s -w "%{http_code}" -o "$DATA_DIR/${POKE}.json" "$API_BASE/$POKE")

    if [ "$HTTP_STATUS" -eq 200 ]; then
        echo "Saved data to $DATA_DIR/${POKE}.json ✅"
    else
        echo "Failed to fetch data for $POKE (HTTP status: $HTTP_STATUS)"
        # Optionally log error to a file
        echo "$(date): Failed to fetch $POKE, HTTP status $HTTP_STATUS" >> error.log
        # Remove incomplete file if exists
        rm -f "$DATA_DIR/${POKE}.json"
    fi

    # Delay to handle API rate limiting (e.g., 1 second)
    sleep 1
done
